id: aem-default-get-servlet
info:
  author: DhiyaneshDk & doppler
  name: AEM DefaultGetServlet
  severity: low
  reference: https://speakerdeck.com/0ang3el/hunting-for-security-bugs-in-aem-webapps?slide=43
  tags: aem


requests:
  - method: GET
    path:
      - '{{BaseURL}}/.json'
      - '{{BaseURL}}/.1.json'
      - '{{BaseURL}}/....4.2.1....json'
      - '{{BaseURL}}/.json?FNZ.css'
      - '{{BaseURL}}/.json?FNZ.ico'
      - '{{BaseURL}}/.json?FNZ.html'
      - '{{BaseURL}}/.json/FNZ.css'
      - '{{BaseURL}}/.json/FNZ.html'
      - '{{BaseURL}}/.json/FNZ.png'
      - '{{BaseURL}}/.json/FNZ.ico'
      - '{{BaseURL}}/.children.1.json'
      - '{{BaseURL}}/.children....4.2.1....json'
      - '{{BaseURL}}/.children.json?FNZ.css'
      - '{{BaseURL}}/.children.json?FNZ.ico'
      - '{{BaseURL}}/.children.json?FNZ.html'
      - '{{BaseURL}}/.children.json/FNZ.css'
      - '{{BaseURL}}/.children.json/FNZ.html'
      - '{{BaseURL}}/.children.json/FNZ.png'
      - '{{BaseURL}}/.children.json/FNZ.ico'
      - '{{BaseURL}}/etc.json'
      - '{{BaseURL}}/etc.1.json'
      - '{{BaseURL}}/etc....4.2.1....json'
      - '{{BaseURL}}/etc.json?FNZ.css'
      - '{{BaseURL}}/etc.json?FNZ.ico'
      - '{{BaseURL}}/etc.json?FNZ.html'
      - '{{BaseURL}}/etc.json/FNZ.css'
      - '{{BaseURL}}/etc.json/FNZ.html'
      - '{{BaseURL}}/etc.json/FNZ.ico'
      - '{{BaseURL}}/etc.children.json'
      - '{{BaseURL}}/etc.children.1.json'
      - '{{BaseURL}}/etc.children....4.2.1....json'
      - '{{BaseURL}}/etc.children.json?FNZ.css'
      - '{{BaseURL}}/etc.children.json?FNZ.ico'
      - '{{BaseURL}}/etc.children.json?FNZ.html'
      - '{{BaseURL}}/etc.children.json/FNZ.css'
      - '{{BaseURL}}/etc.children.json/FNZ.html'
      - '{{BaseURL}}/etc.children.json/FNZ.png'
      - '{{BaseURL}}/etc.children.json/FNZ.ico'
      - '{{BaseURL}}///etc.json'
      - '{{BaseURL}}///etc.1.json'
      - '{{BaseURL}}///etc....4.2.1....json'
      - '{{BaseURL}}///etc.json?FNZ.css'
      - '{{BaseURL}}///etc.json?FNZ.ico'
      - '{{BaseURL}}///etc.json/FNZ.html'
      - '{{BaseURL}}///etc.json/FNZ.png'
      - '{{BaseURL}}///etc.json/FNZ.ico'
      - '{{BaseURL}}///etc.children.json'
      - '{{BaseURL}}///etc.children.1.json'
      - '{{BaseURL}}///etc.children....4.2.1....json'
      - '{{BaseURL}}///etc.children.json?FNZ.css'
      - '{{BaseURL}}///etc.children.json?FNZ.ico'
      - '{{BaseURL}}///etc.children.json?FNZ.html'
      - '{{BaseURL}}///etc.children.json/FNZ.css'
      - '{{BaseURL}}///etc.children.json/FNZ.html'
      - '{{BaseURL}}///etc.children.json/FNZ.png'
      - '{{BaseURL}}///etc.children.json/FNZ.ico'
      - '{{BaseURL}}/content.json'
      - '{{BaseURL}}/content.1.json'
      - '{{BaseURL}}/content....4.2.1....json'
      - '{{BaseURL}}/content.json?FNZ.css'
      - '{{BaseURL}}/content.json?FNZ.ico'
      - '{{BaseURL}}/content.json?FNZ.html'
      - '{{BaseURL}}/content.json/FNZ.css'
      - '{{BaseURL}}/content.json/FNZ.html'
      - '{{BaseURL}}/content.json/FNZ.ico'
      - '{{BaseURL}}/content.children.json'
      - '{{BaseURL}}/content.children.1.json'
      - '{{BaseURL}}/content.children....4.2.1....json'
      - '{{BaseURL}}/content.children.json?FNZ.css'
      - '{{BaseURL}}/content.children.json?FNZ.ico'
      - '{{BaseURL}}/content.children.json?FNZ.html'
      - '{{BaseURL}}/content.children.json/FNZ.css'
      - '{{BaseURL}}/content.children.json/FNZ.html'
      - '{{BaseURL}}/content.children.json/FNZ.png'
      - '{{BaseURL}}/content.children.json/FNZ.ico'
      - '{{BaseURL}}///content.json'
      - '{{BaseURL}}///content.1.json'
      - '{{BaseURL}}///content....4.2.1....json'
      - '{{BaseURL}}///content.json?FNZ.css'
      - '{{BaseURL}}///content.json?FNZ.ico'
      - '{{BaseURL}}///content.json/FNZ.html'
      - '{{BaseURL}}///content.json/FNZ.png'
      - '{{BaseURL}}///content.json/FNZ.ico'
      - '{{BaseURL}}///content.children.json'
      - '{{BaseURL}}///content.children.1.json'
      - '{{BaseURL}}///content.children....4.2.1....json'
      - '{{BaseURL}}///content.children.json?FNZ.css'
      - '{{BaseURL}}///content.children.json?FNZ.ico'
      - '{{BaseURL}}///content.children.json?FNZ.html'
      - '{{BaseURL}}///content.children.json/FNZ.css'
      - '{{BaseURL}}///content.children.json/FNZ.html'
      - '{{BaseURL}}///content.children.json/FNZ.png'
      - '{{BaseURL}}///content.children.json/FNZ.ico'
      - '{{BaseURL}}/var.json'
      - '{{BaseURL}}/var.1.json'
      - '{{BaseURL}}/var....4.2.1....json'
      - '{{BaseURL}}/var.json?FNZ.css'
      - '{{BaseURL}}/var.json?FNZ.ico'
      - '{{BaseURL}}/var.json?FNZ.html'
      - '{{BaseURL}}/var.json/FNZ.css'
      - '{{BaseURL}}/var.json/FNZ.html'
      - '{{BaseURL}}/var.json/FNZ.ico'
      - '{{BaseURL}}/var.children.json'
      - '{{BaseURL}}/var.children.1.json'
      - '{{BaseURL}}/var.children....4.2.1....json'
      - '{{BaseURL}}/var.children.json?FNZ.css'
      - '{{BaseURL}}/var.children.json?FNZ.ico'
      - '{{BaseURL}}/var.children.json?FNZ.html'
      - '{{BaseURL}}/var.children.json/FNZ.css'
      - '{{BaseURL}}/var.children.json/FNZ.html'
      - '{{BaseURL}}/var.children.json/FNZ.png'
      - '{{BaseURL}}/var.children.json/FNZ.ico'
      - '{{BaseURL}}///var.json'
      - '{{BaseURL}}///var.1.json'
      - '{{BaseURL}}///var....4.2.1....json'
      - '{{BaseURL}}///var.json?FNZ.css'
      - '{{BaseURL}}///var.json?FNZ.ico'
      - '{{BaseURL}}///var.json/FNZ.html'
      - '{{BaseURL}}///var.json/FNZ.png'
      - '{{BaseURL}}///var.json/FNZ.ico'
      - '{{BaseURL}}///var.children.json'
      - '{{BaseURL}}///var.children.1.json'
      - '{{BaseURL}}///var.children....4.2.1....json'
      - '{{BaseURL}}///var.children.json?FNZ.css'
      - '{{BaseURL}}///var.children.json?FNZ.ico'
      - '{{BaseURL}}///var.children.json?FNZ.html'
      - '{{BaseURL}}///var.children.json/FNZ.css'
      - '{{BaseURL}}///var.children.json/FNZ.html'
      - '{{BaseURL}}///var.children.json/FNZ.png'
      - '{{BaseURL}}///var.children.json/FNZ.ico'
      - '{{BaseURL}}/bin.json'
      - '{{BaseURL}}/bin.1.json'
      - '{{BaseURL}}/bin....4.2.1....json'
      - '{{BaseURL}}/bin.json?FNZ.css'
      - '{{BaseURL}}/bin.json?FNZ.ico'
      - '{{BaseURL}}/bin.json?FNZ.html'
      - '{{BaseURL}}/bin.json/FNZ.css'
      - '{{BaseURL}}/bin.json/FNZ.html'
      - '{{BaseURL}}/bin.json/FNZ.ico'
      - '{{BaseURL}}/bin.children.json'
      - '{{BaseURL}}/bin.children.1.json'
      - '{{BaseURL}}/bin.children....4.2.1....json'
      - '{{BaseURL}}/bin.children.json?FNZ.css'
      - '{{BaseURL}}/bin.children.json?FNZ.ico'
      - '{{BaseURL}}/bin.children.json?FNZ.html'
      - '{{BaseURL}}/bin.children.json/FNZ.css'
      - '{{BaseURL}}/bin.children.json/FNZ.html'
      - '{{BaseURL}}/bin.children.json/FNZ.png'
      - '{{BaseURL}}/bin.children.json/FNZ.ico'
      - '{{BaseURL}}///bin.json'
      - '{{BaseURL}}///bin.1.json'
      - '{{BaseURL}}///bin....4.2.1....json'
      - '{{BaseURL}}///bin.json?FNZ.css'
      - '{{BaseURL}}///bin.json?FNZ.ico'
      - '{{BaseURL}}///bin.json/FNZ.html'
      - '{{BaseURL}}///bin.json/FNZ.png'
      - '{{BaseURL}}///bin.json/FNZ.ico'
      - '{{BaseURL}}///bin.children.json'
      - '{{BaseURL}}///bin.children.1.json'
      - '{{BaseURL}}///bin.children....4.2.1....json'
      - '{{BaseURL}}///bin.children.json?FNZ.css'
      - '{{BaseURL}}///bin.children.json?FNZ.ico'
      - '{{BaseURL}}///bin.children.json?FNZ.html'
      - '{{BaseURL}}///bin.children.json/FNZ.css'
      - '{{BaseURL}}///bin.children.json/FNZ.html'
      - '{{BaseURL}}///bin.children.json/FNZ.png'
      - '{{BaseURL}}///bin.children.json/FNZ.ico'
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - 'jcr:createdBy'
        condition: and
